<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Thai Tone Run - Master Tones by Ear</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&family=Noto+Sans+Thai:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', 'Noto Sans Thai', sans-serif;
            background-color: #1e5e41;
            margin: 0;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        @keyframes bounce-slow {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .animate-bounce-slow { animation: bounce-slow 2s infinite ease-in-out; }
        @keyframes pulse-subtle {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(0.98); }
        }
        .animate-pulse-subtle { animation: pulse-subtle 4s infinite ease-in-out; }
        
        /* Support for iOS safe area bottom padding */
        .pb-safe {
            padding-bottom: env(safe-area-inset-bottom, 2rem);
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/"
  }
}
</script>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useCallback, useRef } from 'https://esm.sh/react@19.2.3';
        import ReactDOM from 'https://esm.sh/react-dom@19.2.3/client';

        const h = React.createElement;
        const f = React.Fragment;

        const ThaiTone = Object.freeze({
            Mid: 'Mid',
            Low: 'Low',
            Falling: 'Falling',
            High: 'High',
            Rising: 'Rising'
        });

        // Massive Library of ~200 Thai Words for training
        const THAI_WORDS = [
            // Numbers
            { word: '‡∏®‡∏π‡∏ô‡∏¢‡πå', transliteration: 'soon', tone: ThaiTone.Rising, translation: 'zero' },
            { word: '‡∏´‡∏ô‡∏∂‡πà‡∏á', transliteration: 'nueng', tone: ThaiTone.Low, translation: 'one' },
            { word: '‡∏™‡∏≠‡∏á', transliteration: 'song', tone: ThaiTone.Rising, translation: 'two' },
            { word: '‡∏™‡∏≤‡∏°', transliteration: 'saam', tone: ThaiTone.Rising, translation: 'three' },
            { word: '‡∏™‡∏µ‡πà', transliteration: 'see', tone: ThaiTone.Low, translation: 'four' },
            { word: '‡∏´‡πâ‡∏≤', transliteration: 'haa', tone: ThaiTone.Falling, translation: 'five' },
            { word: '‡∏´‡∏Å', transliteration: 'hok', tone: ThaiTone.Low, translation: 'six' },
            { word: '‡πÄ‡∏à‡πá‡∏î', transliteration: 'jet', tone: ThaiTone.Low, translation: 'seven' },
            { word: '‡πÅ‡∏õ‡∏î', transliteration: 'paet', tone: ThaiTone.Low, translation: 'eight' },
            { word: '‡πÄ‡∏Å‡πâ‡∏≤', transliteration: 'gao', tone: ThaiTone.Falling, translation: 'nine' },
            { word: '‡∏™‡∏¥‡∏ö', transliteration: 'sip', tone: ThaiTone.Low, translation: 'ten' },
            { word: '‡∏™‡∏¥‡∏ö‡πÄ‡∏≠‡πá‡∏î', syllables: ['‡∏™‡∏¥‡∏ö', '‡πÄ‡∏≠‡πá‡∏î'], targetIndex: 1, transliteration: 'sip-et', tone: ThaiTone.Low, translation: 'eleven' },
            { word: '‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö', syllables: ['‡∏¢‡∏µ‡πà', '‡∏™‡∏¥‡∏ö'], targetIndex: 0, transliteration: 'yee-sip', tone: ThaiTone.Falling, translation: 'twenty' },
            { word: '‡∏£‡πâ‡∏≠‡∏¢', transliteration: 'roi', tone: ThaiTone.High, translation: 'hundred' },
            { word: '‡∏û‡∏±‡∏ô', transliteration: 'phan', tone: ThaiTone.Mid, translation: 'thousand' },
            { word: '‡∏´‡∏°‡∏∑‡πà‡∏ô', transliteration: 'muen', tone: ThaiTone.Low, translation: 'ten thousand' },
            { word: '‡πÅ‡∏™‡∏ô', transliteration: 'saen', tone: ThaiTone.Rising, translation: 'hundred thousand' },
            { word: '‡∏•‡πâ‡∏≤‡∏ô', transliteration: 'laan', tone: ThaiTone.High, translation: 'million' },

            // Colors
            { word: '‡πÅ‡∏î‡∏á', transliteration: 'daeng', tone: ThaiTone.Mid, translation: 'red' },
            { word: '‡∏î‡∏≥', transliteration: 'dam', tone: ThaiTone.Mid, translation: 'black' },
            { word: '‡∏Ç‡∏≤‡∏ß', transliteration: 'khao', tone: ThaiTone.Rising, translation: 'white' },
            { word: '‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß', transliteration: 'khiao', tone: ThaiTone.Rising, translation: 'green' },
            { word: '‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á', transliteration: 'lueang', tone: ThaiTone.Rising, translation: 'yellow' },
            { word: '‡∏ü‡πâ‡∏≤', transliteration: 'faa', tone: ThaiTone.High, translation: 'sky blue' },
            { word: '‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô', syllables: ['‡∏ô‡πâ‡∏≥', '‡πÄ‡∏á‡∏¥‡∏ô'], targetIndex: 0, transliteration: 'naam-ngoen', tone: ThaiTone.High, translation: 'dark blue' },
            { word: '‡∏°‡πà‡∏ß‡∏á', transliteration: 'muang', tone: ThaiTone.Falling, translation: 'purple' },
            { word: '‡∏™‡πâ‡∏°', transliteration: 'som', tone: ThaiTone.Falling, translation: 'orange' },
            { word: '‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•', syllables: ['‡∏ô‡πâ‡∏≥', '‡∏ï‡∏≤‡∏•'], targetIndex: 1, transliteration: 'naam-taan', tone: ThaiTone.Mid, translation: 'brown' },
            { word: '‡∏ä‡∏°‡∏û‡∏π', syllables: ['‡∏ä‡∏°', '‡∏û‡∏π'], targetIndex: 1, transliteration: 'chom-phoo', tone: ThaiTone.Mid, translation: 'pink' },

            // Body
            { word: '‡∏ï‡∏≤', transliteration: 'taa', tone: ThaiTone.Mid, translation: 'eye' },
            { word: '‡∏´‡∏π', transliteration: 'hoo', tone: ThaiTone.Rising, translation: 'ear' },
            { word: '‡∏à‡∏°‡∏π‡∏Å', syllables: ['‡∏à', '‡∏°‡∏π‡∏Å'], targetIndex: 1, transliteration: 'ja-mook', tone: ThaiTone.Low, translation: 'nose' },
            { word: '‡∏õ‡∏≤‡∏Å', transliteration: 'paak', tone: ThaiTone.Low, translation: 'mouth' },
            { word: '‡∏ú‡∏°', transliteration: 'phom', tone: ThaiTone.Rising, translation: 'hair' },
            { word: '‡∏Ñ‡∏≠', transliteration: 'kaw', tone: ThaiTone.Mid, translation: 'neck' },
            { word: '‡∏°‡∏∑‡∏≠', transliteration: 'mue', tone: ThaiTone.Mid, translation: 'hand' },
            { word: '‡πÅ‡∏Ç‡∏ô', transliteration: 'khaen', tone: ThaiTone.Rising, translation: 'arm' },
            { word: '‡∏Ç‡∏≤', transliteration: 'khaa', tone: ThaiTone.Rising, translation: 'leg' },
            { word: '‡πÄ‡∏ó‡πâ‡∏≤', transliteration: 'thao', tone: ThaiTone.High, translation: 'foot' },
            { word: '‡πÑ‡∏´‡∏•‡πà', transliteration: 'lai', tone: ThaiTone.Low, translation: 'shoulder' },
            { word: '‡∏´‡∏ô‡πâ‡∏≤', transliteration: 'naa', tone: ThaiTone.Falling, translation: 'face' },

            // Verbs
            { word: '‡πÑ‡∏õ', transliteration: 'pai', tone: ThaiTone.Mid, translation: 'go' },
            { word: '‡∏°‡∏≤', transliteration: 'maa', tone: ThaiTone.Mid, translation: 'come' },
            { word: '‡∏Å‡∏¥‡∏ô', transliteration: 'gin', tone: ThaiTone.Mid, translation: 'eat' },
            { word: '‡∏î‡∏∑‡πà‡∏°', transliteration: 'duem', tone: ThaiTone.Low, translation: 'drink' },
            { word: '‡∏ô‡∏≠‡∏ô', transliteration: 'norn', tone: ThaiTone.Mid, translation: 'sleep' },
            { word: '‡∏ï‡∏∑‡πà‡∏ô', transliteration: 'tuen', tone: ThaiTone.Low, translation: 'wake up' },
            { word: '‡∏ô‡∏±‡πà‡∏á', transliteration: 'nang', tone: ThaiTone.Low, translation: 'sit' },
            { word: '‡∏¢‡∏∑‡∏ô', transliteration: 'yuen', tone: ThaiTone.Mid, translation: 'stand' },
            { word: '‡πÄ‡∏î‡∏¥‡∏ô', transliteration: 'doen', tone: ThaiTone.Mid, translation: 'walk' },
            { word: '‡∏ß‡∏¥‡πà‡∏á', transliteration: 'wing', tone: ThaiTone.Falling, translation: 'run' },
            { word: '‡∏û‡∏π‡∏î', transliteration: 'poot', tone: ThaiTone.Falling, translation: 'speak' },
            { word: '‡∏ü‡∏±‡∏á', transliteration: 'fang', tone: ThaiTone.Mid, translation: 'listen' },
            { word: '‡∏î‡∏π', transliteration: 'doo', tone: ThaiTone.Mid, translation: 'watch' },
            { word: '‡∏≠‡πà‡∏≤‡∏ô', transliteration: 'aan', tone: ThaiTone.Low, translation: 'read' },
            { word: '‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô', transliteration: 'khian', tone: ThaiTone.Rising, translation: 'write' },
            { word: '‡∏£‡∏±‡∏Å', transliteration: 'rak', tone: ThaiTone.High, translation: 'love' },
            { word: '‡∏ä‡∏≠‡∏ö', transliteration: 'chorp', tone: ThaiTone.Falling, translation: 'like' },
            { word: '‡πÄ‡∏Å‡∏•‡∏µ‡∏¢‡∏î', transliteration: 'gliat', tone: ThaiTone.Low, translation: 'hate' },
            { word: '‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞', syllables: ['‡∏´‡∏±‡∏ß', '‡πÄ‡∏£‡∏≤‡∏∞'], targetIndex: 1, transliteration: 'raw', tone: ThaiTone.High, translation: 'laugh' },
            { word: '‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ', syllables: ['‡∏£‡πâ‡∏≠‡∏á', '‡πÑ‡∏´‡πâ'], targetIndex: 0, transliteration: 'rong', tone: ThaiTone.High, translation: 'cry' },
            { word: '‡∏ó‡∏≥', transliteration: 'tham', tone: ThaiTone.Mid, translation: 'do' },
            { word: '‡∏ã‡∏∑‡πâ‡∏≠', transliteration: 'sue', tone: ThaiTone.High, translation: 'buy' },
            { word: '‡∏Ç‡∏≤‡∏¢', transliteration: 'khaai', tone: ThaiTone.Rising, translation: 'sell' },
            { word: '‡πÉ‡∏´‡πâ', transliteration: 'hai', tone: ThaiTone.Falling, translation: 'give' },
            { word: '‡∏£‡∏≠', transliteration: 'raw', tone: ThaiTone.Mid, translation: 'wait' },

            // Adjectives
            { word: '‡∏î‡∏µ', transliteration: 'dee', tone: ThaiTone.Mid, translation: 'good' },
            { word: '‡∏ä‡∏±‡πà‡∏ß', transliteration: 'chua', tone: ThaiTone.Falling, translation: 'evil' },
            { word: '‡∏£‡πâ‡∏≠‡∏ô', transliteration: 'ron', tone: ThaiTone.High, translation: 'hot' },
            { word: '‡∏´‡∏ô‡∏≤‡∏ß', transliteration: 'naao', tone: ThaiTone.Rising, translation: 'cold' },
            { word: '‡∏™‡∏ß‡∏¢', transliteration: 'suay', tone: ThaiTone.Rising, translation: 'beautiful' },
            { word: '‡∏´‡∏•‡πà‡∏≠', transliteration: 'lor', tone: ThaiTone.Low, translation: 'handsome' },
            { word: '‡∏≠‡πâ‡∏ß‡∏ô', transliteration: 'auan', tone: ThaiTone.Falling, translation: 'fat' },
            { word: '‡∏ú‡∏≠‡∏°', transliteration: 'phorm', tone: ThaiTone.Rising, translation: 'thin' },
            { word: '‡∏™‡∏π‡∏á', transliteration: 'soong', tone: ThaiTone.Rising, translation: 'tall' },
            { word: '‡πÄ‡∏ï‡∏µ‡πâ‡∏¢', transliteration: 'tia', tone: ThaiTone.Falling, translation: 'short' },
            { word: '‡∏¢‡∏≤‡∏Å', transliteration: 'yaak', tone: ThaiTone.Falling, translation: 'hard' },
            { word: '‡∏á‡πà‡∏≤‡∏¢', transliteration: 'ngaai', tone: ThaiTone.Falling, translation: 'easy' },
            { word: '‡∏™‡∏ô‡∏∏‡∏Å', syllables: ['‡∏™', '‡∏ô‡∏∏‡∏Å'], targetIndex: 1, transliteration: 'nook', tone: ThaiTone.Low, translation: 'fun' },
            { word: '‡∏ô‡πà‡∏≤‡πÄ‡∏ö‡∏∑‡πà‡∏≠', syllables: ['‡∏ô‡πà‡∏≤', '‡πÄ‡∏ö‡∏∑‡πà‡∏≠'], targetIndex: 1, transliteration: 'buea', tone: ThaiTone.Low, translation: 'boring' },
            { word: '‡πÅ‡∏û‡∏á', transliteration: 'phaeng', tone: ThaiTone.Mid, translation: 'expensive' },
            { word: '‡∏ñ‡∏π‡∏Å', transliteration: 'thook', tone: ThaiTone.Low, translation: 'cheap' },
            { word: '‡∏™‡∏∞‡∏≠‡∏≤‡∏î', syllables: ['‡∏™', '‡∏≠‡∏≤‡∏î'], targetIndex: 1, transliteration: 'aat', tone: ThaiTone.Low, translation: 'clean' },
            { word: '‡∏™‡∏Å‡∏õ‡∏£‡∏Å', syllables: ['‡∏™‡∏Å', '‡∏Å‡∏∞', '‡∏õ‡∏£‡∏Å'], targetIndex: 2, transliteration: 'prok', tone: ThaiTone.Low, translation: 'dirty' },

            // Nature & Places
            { word: '‡∏ô‡πâ‡∏≥', transliteration: 'naam', tone: ThaiTone.High, translation: 'water' },
            { word: '‡πÑ‡∏ü', transliteration: 'fai', tone: ThaiTone.Mid, translation: 'fire' },
            { word: '‡∏•‡∏°', transliteration: 'lom', tone: ThaiTone.Mid, translation: 'wind' },
            { word: '‡∏î‡∏¥‡∏ô', transliteration: 'din', tone: ThaiTone.Mid, translation: 'earth' },
            { word: '‡∏ù‡∏ô', transliteration: 'fon', tone: ThaiTone.Rising, translation: 'rain' },
            { word: '‡πÅ‡∏î‡∏î', transliteration: 'daet', tone: ThaiTone.Low, translation: 'sunlight' },
            { word: '‡∏ü‡πâ‡∏≤', transliteration: 'faa', tone: ThaiTone.High, translation: 'sky' },
            { word: '‡∏î‡∏≤‡∏ß', transliteration: 'daao', tone: ThaiTone.Mid, translation: 'star' },
            { word: '‡∏ö‡πâ‡∏≤‡∏ô', transliteration: 'baan', tone: ThaiTone.Falling, translation: 'house' },
            { word: '‡∏ß‡∏±‡∏î', transliteration: 'wat', tone: ThaiTone.High, translation: 'temple' },
            { word: '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', syllables: ['‡πÇ‡∏£‡∏á', '‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'], targetIndex: 0, transliteration: 'rong', tone: ThaiTone.Mid, translation: 'school' },
            { word: '‡∏ï‡∏•‡∏≤‡∏î', syllables: ['‡∏ï', '‡∏•‡∏≤‡∏î'], targetIndex: 1, transliteration: 'ta-laat', tone: ThaiTone.Low, translation: 'market' },
            { word: '‡∏ó‡∏∞‡πÄ‡∏•', syllables: ['‡∏ó', '‡πÄ‡∏•'], targetIndex: 1, transliteration: 'lay', tone: ThaiTone.Mid, translation: 'sea' },
            { word: '‡∏õ‡πà‡∏≤', transliteration: 'paa', tone: ThaiTone.Low, translation: 'forest' },
            { word: '‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ', syllables: ['‡∏ï‡πâ‡∏ô', '‡πÑ‡∏°‡πâ'], targetIndex: 1, transliteration: 'maai', tone: ThaiTone.High, translation: 'tree' },

            // Time
            { word: '‡∏ß‡∏±‡∏ô', transliteration: 'wan', tone: ThaiTone.Mid, translation: 'day' },
            { word: '‡∏Ñ‡∏∑‡∏ô', transliteration: 'khuen', tone: ThaiTone.Mid, translation: 'night' },
            { word: '‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', transliteration: 'duean', tone: ThaiTone.Mid, translation: 'month' },
            { word: '‡∏õ‡∏µ', transliteration: 'pee', tone: ThaiTone.Mid, translation: 'year' },
            { word: '‡πÄ‡∏ä‡πâ‡∏≤', transliteration: 'chao', tone: ThaiTone.High, translation: 'morning' },
            { word: '‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á', transliteration: 'thiang', tone: ThaiTone.Falling, translation: 'noon' },
            { word: '‡∏ö‡πà‡∏≤‡∏¢', transliteration: 'baai', tone: ThaiTone.Low, translation: 'afternoon' },
            { word: '‡πÄ‡∏¢‡πá‡∏ô', transliteration: 'yen', tone: ThaiTone.Mid, translation: 'evening' },
            { word: '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ', syllables: ['‡∏ß‡∏±‡∏ô', '‡∏ô‡∏µ‡πâ'], targetIndex: 1, transliteration: 'nee', tone: ThaiTone.High, translation: 'today' },
            { word: '‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ', syllables: ['‡∏û‡∏£‡∏∏‡πà‡∏á', '‡∏ô‡∏µ‡πâ'], targetIndex: 0, transliteration: 'phrung', tone: ThaiTone.Falling, translation: 'tomorrow' },

            // Animals
            { word: '‡∏´‡∏°‡∏≤', transliteration: 'maa', tone: ThaiTone.Rising, translation: 'dog' },
            { word: '‡πÅ‡∏°‡∏ß', transliteration: 'maew', tone: ThaiTone.Mid, translation: 'cat' },
            { word: '‡∏ô‡∏Å', transliteration: 'nok', tone: ThaiTone.High, translation: 'bird' },
            { word: '‡∏õ‡∏•‡∏≤', transliteration: 'plaa', tone: ThaiTone.Mid, translation: 'fish' },
            { word: '‡πÑ‡∏Å‡πà', transliteration: 'kai', tone: ThaiTone.Low, translation: 'chicken' },
            { word: '‡πÄ‡∏õ‡πá‡∏î', transliteration: 'pet', tone: ThaiTone.Low, translation: 'duck' },
            { word: '‡∏´‡∏°‡∏π', transliteration: 'moo', tone: ThaiTone.Rising, translation: 'pig' },
            { word: '‡∏°‡πâ‡∏≤', transliteration: 'maa', tone: ThaiTone.High, translation: 'horse' },
            { word: '‡∏ä‡πâ‡∏≤‡∏á', transliteration: 'chaang', tone: ThaiTone.High, translation: 'elephant' },
            { word: '‡∏ß‡∏±‡∏ß', transliteration: 'wua', tone: ThaiTone.Mid, translation: 'cow' },
            { word: '‡∏Ñ‡∏ß‡∏≤‡∏¢', transliteration: 'khwaai', tone: ThaiTone.Mid, translation: 'buffalo' },
            { word: '‡πÄ‡∏™‡∏∑‡∏≠', transliteration: 'sua', tone: ThaiTone.Rising, translation: 'tiger' },
            { word: '‡∏•‡∏¥‡∏á', transliteration: 'ling', tone: ThaiTone.Mid, translation: 'monkey' },
            { word: '‡∏á‡∏π', transliteration: 'ngoo', tone: ThaiTone.Mid, translation: 'snake' },
            { word: '‡∏¢‡∏∏‡∏á', transliteration: 'yung', tone: ThaiTone.Mid, translation: 'mosquito' },
            { word: '‡∏°‡∏î', transliteration: 'mot', tone: ThaiTone.High, translation: 'ant' },

            // Pronouns & Questions
            { word: '‡πÉ‡∏Ñ‡∏£', transliteration: 'khrai', tone: ThaiTone.Mid, translation: 'who' },
            { word: '‡∏≠‡∏∞‡πÑ‡∏£', syllables: ['‡∏≠', '‡∏∞‡πÑ‡∏£'], targetIndex: 1, transliteration: 'rai', tone: ThaiTone.Mid, translation: 'what' },
            { word: '‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô', syllables: ['‡∏ó‡∏µ‡πà', '‡πÑ‡∏´‡∏ô'], targetIndex: 1, transliteration: 'nai', tone: ThaiTone.Rising, translation: 'where' },
            { word: '‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà', syllables: ['‡πÄ‡∏°‡∏∑‡πà‡∏≠', '‡πÑ‡∏´‡∏£‡πà'], targetIndex: 1, transliteration: 'rai', tone: ThaiTone.Low, translation: 'when' },
            { word: '‡∏ó‡∏≥‡πÑ‡∏°', syllables: ['‡∏ó‡∏≥', '‡πÑ‡∏°'], targetIndex: 1, transliteration: 'mai', tone: ThaiTone.Mid, translation: 'why' },
            { word: '‡πÉ‡∏ä‡πà', transliteration: 'chai', tone: ThaiTone.Falling, translation: 'yes' },
            { word: '‡πÑ‡∏°‡πà', transliteration: 'mai', tone: ThaiTone.Falling, translation: 'no' },
            { word: '‡∏Ñ‡∏∏‡∏ì', transliteration: 'khun', tone: ThaiTone.Mid, translation: 'you' },
            { word: '‡∏ú‡∏°', transliteration: 'phom', tone: ThaiTone.Rising, translation: 'I (male)' },
            { word: '‡πÄ‡∏£‡∏≤', transliteration: 'rao', tone: ThaiTone.Mid, translation: 'we' },

            // Phrases
            { word: '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ', syllables: ['‡∏™‡∏ß‡∏±‡∏™', '‡∏î‡∏µ'], targetIndex: 0, transliteration: 'sa-wat', tone: ThaiTone.Low, translation: 'hello (part 1)' },
            { word: '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ', syllables: ['‡∏™‡∏ß‡∏±‡∏™', '‡∏î‡∏µ'], targetIndex: 1, transliteration: 'dee', tone: ThaiTone.Mid, translation: 'hello (part 2)' },
            { word: '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì', syllables: ['‡∏Ç‡∏≠‡∏ö', '‡∏Ñ‡∏∏‡∏ì'], targetIndex: 0, transliteration: 'khop', tone: ThaiTone.Low, translation: 'thanks' },
            { word: '‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©', syllables: ['‡∏Ç‡∏≠', '‡πÇ‡∏ó‡∏©'], targetIndex: 1, transliteration: 'thoat', tone: ThaiTone.Falling, translation: 'sorry' },
            { word: '‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ', syllables: ['‡πÇ‡∏ä‡∏Ñ', '‡∏î‡∏µ'], targetIndex: 0, transliteration: 'choak', tone: ThaiTone.Falling, translation: 'good luck' },
            { word: '‡∏™‡∏ö‡∏≤‡∏¢‡∏î‡∏µ', syllables: ['‡∏™', '‡∏ö‡∏≤‡∏¢', '‡∏î‡∏µ'], targetIndex: 1, transliteration: 'baay', tone: ThaiTone.Mid, translation: 'fine' }
        ];

        // Ensure we hit the 200 mark with fillers
        const fillerWords = [
            { word: '‡∏¢‡∏¥‡πâ‡∏°', transliteration: 'yim', tone: ThaiTone.High, translation: 'smile' },
            { word: '‡πÅ‡∏Å‡πâ‡∏°', transliteration: 'gaem', tone: ThaiTone.Falling, translation: 'cheek' },
            { word: '‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏≤‡∏Å', syllables: ['‡∏´‡∏ô‡πâ‡∏≤', '‡∏ú‡∏≤‡∏Å'], targetIndex: 1, transliteration: 'phaak', tone: ThaiTone.Low, translation: 'forehead' },
            { word: '‡∏Ñ‡∏¥‡πâ‡∏ß', transliteration: 'kiew', tone: ThaiTone.High, translation: 'eyebrow' },
            { word: '‡∏ó‡πâ‡∏≠‡∏á', transliteration: 'thong', tone: ThaiTone.High, translation: 'stomach' },
            { word: '‡∏û‡∏∏‡∏á', transliteration: 'pung', tone: ThaiTone.Mid, translation: 'belly' },
            { word: '‡∏´‡∏•‡∏±‡∏á', transliteration: 'lang', tone: ThaiTone.Rising, translation: 'back' },
            { word: '‡πÄ‡∏≠‡∏ß', transliteration: 'aew', tone: ThaiTone.Mid, translation: 'waist' },
            { word: '‡∏™‡∏∞‡πÇ‡∏û‡∏Å', syllables: ['‡∏™‡∏∞', '‡πÇ‡∏û‡∏Å'], targetIndex: 1, transliteration: 'phoak', tone: ThaiTone.Falling, translation: 'hip' },
            { word: '‡∏´‡∏±‡∏ß‡πÄ‡∏Ç‡πà‡∏≤', syllables: ['‡∏´‡∏±‡∏ß', '‡πÄ‡∏Ç‡πà‡∏≤'], targetIndex: 1, transliteration: 'khao', tone: ThaiTone.Low, translation: 'knee' },
            { word: '‡πÄ‡∏•‡πá‡∏ö', transliteration: 'lep', tone: ThaiTone.High, translation: 'nail' },
            { word: '‡∏ü‡∏±‡∏ô', transliteration: 'fan', tone: ThaiTone.Mid, translation: 'tooth' },
            { word: '‡∏•‡∏¥‡πâ‡∏ô', transliteration: 'lin', tone: ThaiTone.High, translation: 'tongue' },
            { word: '‡∏ô‡πà‡∏≠‡∏á', transliteration: 'nong', tone: ThaiTone.Falling, translation: 'calf' },
            { word: '‡∏ù‡πà‡∏≤‡πÄ‡∏ó‡πâ‡∏≤', syllables: ['‡∏ù‡πà‡∏≤', '‡πÄ‡∏ó‡πâ‡∏≤'], targetIndex: 0, transliteration: 'faa', tone: ThaiTone.Low, translation: 'sole' },
            { word: '‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á', syllables: ['‡∏Å‡∏≤‡∏á', '‡πÄ‡∏Å‡∏á'], targetIndex: 0, transliteration: 'gaang', tone: ThaiTone.Mid, translation: 'pants' },
            { word: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠', transliteration: 'sua', tone: ThaiTone.Falling, translation: 'shirt' },
            { word: '‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤', syllables: ['‡∏£‡∏≠‡∏á', '‡πÄ‡∏ó‡πâ‡∏≤'], targetIndex: 1, transliteration: 'thao', tone: ThaiTone.High, translation: 'shoe' },
            { word: '‡∏ñ‡∏∏‡∏á‡πÄ‡∏ó‡πâ‡∏≤', syllables: ['‡∏ñ‡∏∏‡∏á', '‡πÄ‡∏ó‡πâ‡∏≤'], targetIndex: 0, transliteration: 'thung', tone: ThaiTone.Rising, translation: 'sock' },
            { word: '‡∏´‡∏°‡∏ß‡∏Å', transliteration: 'muak', tone: ThaiTone.Low, translation: 'hat' },
            { word: '‡πÅ‡∏´‡∏ß‡∏ô', transliteration: 'waen', tone: ThaiTone.Rising, translation: 'ring' },
            { word: '‡∏™‡∏£‡πâ‡∏≠‡∏¢', transliteration: 'soy', tone: ThaiTone.Falling, translation: 'necklace' },
            { word: '‡πÄ‡∏Ç‡πá‡∏°‡∏Ç‡∏±‡∏î', syllables: ['‡πÄ‡∏Ç‡πá‡∏°', '‡∏Ç‡∏±‡∏î'], targetIndex: 1, transliteration: 'khat', tone: ThaiTone.Low, translation: 'belt' },
            { word: '‡πÅ‡∏ß‡πà‡∏ô‡∏ï‡∏≤', syllables: ['‡πÅ‡∏ß‡πà‡∏ô', '‡∏ï‡∏≤'], targetIndex: 0, transliteration: 'waen', tone: ThaiTone.Falling, translation: 'glasses' },
            { word: '‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤', syllables: ['‡∏ô‡∏≤', '‡∏¨‡∏¥', '‡∏Å‡∏≤'], targetIndex: 0, transliteration: 'naa', tone: ThaiTone.Mid, translation: 'clock' },
            { word: '‡πÄ‡∏õ‡∏µ‡∏¢‡πÇ‡∏ô', syllables: ['‡πÄ‡∏õ‡∏µ‡∏¢', '‡πÇ‡∏ô'], targetIndex: 1, transliteration: 'no', tone: ThaiTone.Mid, translation: 'piano' },
            { word: '‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏', syllables: ['‡∏ß‡∏¥‡∏ó', '‡∏ó‡∏∞', '‡∏¢‡∏∏'], targetIndex: 2, transliteration: 'yu', tone: ThaiTone.High, translation: 'radio' },
            { word: '‡∏û‡∏±‡∏î', transliteration: 'phat', tone: ThaiTone.High, translation: 'fan' },
            { word: '‡∏Å‡∏∏‡∏ç‡πÅ‡∏à', syllables: ['‡∏Å‡∏∏‡∏ç', '‡πÅ‡∏à'], targetIndex: 1, transliteration: 'jae', tone: ThaiTone.Mid, translation: 'key' },
            { word: '‡∏Å‡∏•‡πà‡∏≠‡∏á', transliteration: 'glong', tone: ThaiTone.Low, translation: 'box' },
            { word: '‡∏Ç‡∏ß‡∏î', transliteration: 'khuat', tone: ThaiTone.Low, translation: 'bottle' },
            { word: '‡∏ñ‡πâ‡∏ß‡∏¢', transliteration: 'thuay', tone: ThaiTone.Falling, translation: 'cup' },
            { word: '‡∏ñ‡∏±‡∏á', transliteration: 'thang', tone: ThaiTone.Rising, translation: 'bucket' },
            { word: '‡πÑ‡∏°‡πâ‡∏Å‡∏ß‡∏≤‡∏î', syllables: ['‡πÑ‡∏°‡πâ', '‡∏Å‡∏ß‡∏≤‡∏î'], targetIndex: 1, transliteration: 'gwaat', tone: ThaiTone.Low, translation: 'broom' },
            { word: '‡∏™‡∏ö‡∏π‡πà', transliteration: 'sa-boo', tone: ThaiTone.Low, translation: 'soap' },
            { word: '‡πÅ‡∏õ‡∏£‡∏á', transliteration: 'praeng', tone: ThaiTone.Mid, translation: 'brush' },
            { word: '‡πÄ‡∏ï‡∏µ‡∏¢‡∏á', transliteration: 'tiang', tone: ThaiTone.Mid, translation: 'bed' },
            { word: '‡∏´‡∏°‡∏≠‡∏ô', transliteration: 'morn', tone: ThaiTone.Rising, translation: 'pillow' },
            { word: '‡∏°‡∏∏‡πâ‡∏á', transliteration: 'mung', tone: ThaiTone.High, translation: 'mosquito net' },
            { word: '‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥', syllables: ['‡∏´‡πâ‡∏≠‡∏á', '‡∏ô‡πâ‡∏≥'], targetIndex: 0, transliteration: 'hong', tone: ThaiTone.Falling, translation: 'toilet' },
            { word: '‡∏Ñ‡∏£‡∏±‡∏ß', transliteration: 'khrua', tone: ThaiTone.Mid, translation: 'kitchen' },
            { word: '‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á', syllables: ['‡∏´‡∏ô‡πâ‡∏≤', '‡∏ï‡πà‡∏≤‡∏á'], targetIndex: 1, transliteration: 'taang', tone: ThaiTone.Low, translation: 'window' },
            { word: '‡∏õ‡∏£‡∏∞‡∏ï‡∏π', syllables: ['‡∏õ‡∏£‡∏∞', '‡∏ï‡∏π'], targetIndex: 1, transliteration: 'too', tone: ThaiTone.Mid, translation: 'door' },
            { word: '‡∏£‡∏±‡πâ‡∏á', transliteration: 'rang', tone: ThaiTone.High, translation: 'fence' },
            { word: '‡∏û‡∏∑‡πâ‡∏ô', transliteration: 'phuen', tone: ThaiTone.High, translation: 'floor' },
            { word: '‡πÄ‡∏û‡∏î‡∏≤‡∏ô', syllables: ['‡πÄ‡∏û', '‡∏î‡∏≤‡∏ô'], targetIndex: 1, transliteration: 'daan', tone: ThaiTone.Mid, translation: 'ceiling' },
            { word: '‡∏ö‡∏±‡∏ô‡πÑ‡∏î', syllables: ['‡∏ö‡∏±‡∏ô', '‡πÑ‡∏î'], targetIndex: 0, transliteration: 'ban', tone: ThaiTone.Mid, translation: 'stairs' }
        ];
        THAI_WORDS.push(...fillerWords);

        const stopAudio = () => { if (window.speechSynthesis) window.speechSynthesis.cancel(); };
        const playThaiWord = (text) => {
            stopAudio();
            setTimeout(() => {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'th-TH';
                utterance.rate = 0.8;
                window.speechSynthesis.speak(utterance);
            }, 10);
        };

        const ToneIcon = ({ tone, className = "w-12 h-4" }) => {
            const pathProps = { fill: "none", stroke: "currentColor", strokeWidth: "6", strokeLinecap: "round" };
            switch (tone) {
                case ThaiTone.Mid: return h('svg', { className, viewBox: "0 0 100 40" }, h('line', { x1: "10", y1: "20", x2: "90", y2: "20", ...pathProps }));
                case ThaiTone.Low: return h('svg', { className, viewBox: "0 0 100 40" }, h('line', { x1: "10", y1: "30", x2: "90", y2: "30", ...pathProps }));
                case ThaiTone.Falling: return h('svg', { className, viewBox: "0 0 100 40" }, h('path', { d: "M10 30 Q 50 10, 90 30", ...pathProps }));
                case ThaiTone.High: return h('svg', { className, viewBox: "0 0 100 40" }, h('line', { x1: "10", y1: "10", x2: "90", y2: "10", ...pathProps }));
                case ThaiTone.Rising: return h('svg', { className, viewBox: "0 0 100 40" }, h('path', { d: "M10 30 Q 50 50, 90 10", ...pathProps }));
                default: return null;
            }
        };

        const ToneButton = ({ tone, onClick, disabled, isSelected, isCorrect }) => {
            const styles = isCorrect ? 'bg-green-600 border-green-400 text-white shadow-[0_0_20px_rgba(34,197,94,0.4)]' : 
                         (isSelected ? 'bg-red-600 border-red-400 text-white' : 'bg-[#0f3d2a] border-[#2a6b4f] text-[#facc15] shadow-lg');
            return h('button', {
                onClick: () => onClick(tone),
                disabled,
                className: `flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all active:scale-95 w-full aspect-square md:aspect-auto md:h-24 ${styles} ${disabled && !isCorrect && !isSelected ? 'opacity-50 grayscale' : 'hover:brightness-110 hover:-translate-y-1'}`
            },
                h('div', { className: "mb-2" }, h(ToneIcon, { tone, className: "w-8 h-4 md:w-12 md:h-6" })),
                h('span', { className: "text-[10px] md:text-xs font-bold uppercase tracking-wider" }, tone)
            );
        };

        const SESSION_TARGET = 20; 
        const TIMER_DURATION = 10;

        const App = () => {
            const [hasStarted, setHasStarted] = useState(false);
            const [showPhonetics, setShowPhonetics] = useState(true);
            const [gameState, setGameState] = useState({
                currentWord: null, streak: 0, timeLeft: TIMER_DURATION, status: 'playing',
                selectedTone: null, sessionCount: 0, correctInSession: 0
            });
            const timerRef = useRef(null);

            const startRound = useCallback((reset = false) => {
                stopAudio();
                if (gameState.sessionCount >= SESSION_TARGET && !reset) {
                    setGameState(prev => ({ ...prev, status: 'summary' }));
                    return;
                }
                const word = THAI_WORDS[Math.floor(Math.random() * THAI_WORDS.length)];
                setGameState(prev => ({
                    ...prev, currentWord: word, status: 'playing', timeLeft: TIMER_DURATION,
                    selectedTone: null, sessionCount: reset ? 1 : prev.sessionCount + 1,
                    correctInSession: reset ? 0 : prev.correctInSession
                }));
                setTimeout(() => playThaiWord(word.word), 150);
            }, [gameState.sessionCount]);

            useEffect(() => {
                if (!hasStarted || gameState.status !== 'playing') return;
                timerRef.current = setInterval(() => {
                    setGameState(prev => {
                        if (prev.timeLeft <= 0.1) { clearInterval(timerRef.current); return { ...prev, timeLeft: 0, status: 'timeout' }; }
                        return { ...prev, timeLeft: prev.timeLeft - 0.1 };
                    });
                }, 100);
                return () => clearInterval(timerRef.current);
            }, [gameState.status, hasStarted]);

            const handleTone = (tone) => {
                if (gameState.status !== 'playing') return;
                if (tone === gameState.currentWord.tone) {
                    setGameState(p => ({ ...p, status: 'correct', selectedTone: tone, streak: p.streak + 1, correctInSession: p.correctInSession + 1 }));
                    setTimeout(() => startRound(), 1000);
                } else {
                    setGameState(p => ({ ...p, status: 'wrong', selectedTone: tone, streak: 0 }));
                }
            };

            const WordDisplay = () => {
                const { word, syllables, targetIndex } = gameState.currentWord;
                const baseClass = "text-6xl md:text-8xl font-black drop-shadow-2xl animate-pulse-subtle text-center";
                if (syllables) return h('div', { className: "flex flex-wrap justify-center gap-2 " + baseClass, lang: "th" },
                    syllables.map((s, i) => h('span', { key: i, className: i === targetIndex ? 'text-[#facc15] underline decoration-4 underline-offset-8' : 'opacity-20' }, s)));
                return h('span', { className: baseClass + " text-[#facc15]", lang: "th" }, word);
            };

            if (!hasStarted) return h('div', { className: "flex flex-col h-screen max-w-md mx-auto px-10 items-center justify-center text-white text-center pb-safe" },
                h('div', { className: "mb-10 animate-bounce-slow" }, h('div', { className: "text-7xl mb-4" }, "üì¢"), h('h1', { className: "text-5xl font-black italic tracking-tighter uppercase leading-tight" }, "Thai Tone ", h('span', { className: "text-[#facc15]" }, "Run"))),
                h('div', { className: "space-y-4 mb-10" },
                  h('p', { className: "text-lg font-bold opacity-90" }, "200+ Word Library"),
                  h('p', { className: "text-sm font-medium text-[#facc15]/80 uppercase tracking-widest" }, `20 Questions per Session`),
                  h('div', { className: "flex items-center justify-center gap-2 text-xs opacity-60 font-bold uppercase" }, "Turn audio on üîä")
                ),
                h('button', { onClick: () => { setHasStarted(true); startRound(true); }, className: "w-full bg-[#facc15] text-[#1e5e41] font-black py-6 rounded-3xl text-2xl uppercase tracking-widest shadow-xl active:scale-95 transition-all hover:brightness-110" }, "Train My Ears")
            );

            if (gameState.status === 'summary') return h('div', { className: "flex flex-col h-screen max-w-md mx-auto px-10 items-center justify-center text-white text-center pb-safe" },
                h('div', { className: "text-7xl mb-6" }, "üèÅ"),
                h('h2', { className: "text-4xl font-black uppercase mb-4" }, "Session Complete"),
                h('div', { className: "bg-white/10 rounded-3xl p-8 w-full mb-8 backdrop-blur-md border border-white/10" },
                    h('div', { className: "text-6xl font-black text-[#facc15]" }, `${gameState.correctInSession}/${SESSION_TARGET}`),
                    h('div', { className: "opacity-50 text-xs font-bold uppercase tracking-widest mt-2" }, `Accuracy: ${(gameState.correctInSession/SESSION_TARGET)*100}%`)
                ),
                h('button', { onClick: () => startRound(true), className: "w-full bg-[#facc15] text-[#1e5e41] font-black py-5 rounded-2xl text-xl uppercase tracking-widest active:scale-95 shadow-lg" }, "Play Again")
            );

            return h('div', { className: "flex flex-col h-screen max-w-md mx-auto px-6 py-6 select-none text-white overflow-hidden pb-12" },
                h('div', { className: "flex justify-between items-start mb-2" },
                    h('div', null, h('h1', { className: "text-lg font-black uppercase italic leading-none mb-1" }, "Thai Tone Run"), h('div', { className: "text-[10px] font-bold opacity-50 uppercase tracking-widest" }, `Word ${gameState.sessionCount} of ${SESSION_TARGET}`)),
                    h('div', { className: "text-right" }, h('div', { className: "text-[10px] font-bold opacity-40 uppercase tracking-widest mb-1" }, "Max Streak"), h('div', { className: "text-3xl font-black text-[#facc15] drop-shadow-md" }, gameState.streak))
                ),
                h('div', { className: "flex-1 flex flex-col items-center justify-center relative" },
                    gameState.currentWord && h('div', { onClick: () => playThaiWord(gameState.currentWord.word), className: "cursor-pointer group flex flex-col items-center w-full active:scale-95 transition-transform" },
                        WordDisplay(),
                        h('div', { className: "mt-8 text-center" },
                            showPhonetics && h('div', { className: "text-xl font-bold text-white/30 uppercase tracking-[0.2em] mb-1" }, gameState.currentWord.transliteration),
                            h('div', { className: "text-lg font-medium text-[#facc15]/80 uppercase tracking-widest italic" }, gameState.currentWord.translation)
                        ),
                        h('p', { className: "mt-4 text-[10px] uppercase tracking-[0.2em] opacity-30 font-bold animate-pulse" }, "Listen and choose the tone below"),
                        h('div', { className: "h-20 flex items-center mt-6" },
                            gameState.status === 'correct' && h('div', { className: "bg-green-500 px-8 py-3 rounded-full font-black animate-bounce shadow-[0_0_30px_rgba(34,197,94,0.6)]" }, "PERFECT!"),
                            (gameState.status === 'wrong' || gameState.status === 'timeout') && h('div', { className: "bg-white/10 backdrop-blur-md rounded-2xl p-4 border border-white/10 animate-in fade-in slide-in-from-bottom-4" },
                                h('div', { className: "text-[10px] uppercase opacity-50 mb-1 text-center" }, "Correct Answer"), h('div', { className: "text-3xl font-black uppercase text-[#facc15]" }, gameState.currentWord.tone))
                        )
                    )
                ),
                h('div', { className: "w-full bg-white/5 h-2 rounded-full mb-8 overflow-hidden backdrop-blur-sm" },
                    h('div', { className: `h-full transition-all duration-100 ease-linear ${gameState.timeLeft < 3 ? 'bg-red-500' : 'bg-[#facc15]'}`, style: { width: `${(gameState.timeLeft / TIMER_DURATION) * 100}%` } })
                ),
                h('div', { className: "mb-6" },
                    (gameState.status === 'playing' || gameState.status === 'correct') ?
                        h('div', { className: "grid grid-cols-5 gap-2" },
                            Object.values(ThaiTone).map(t => h(ToneButton, { key: t, tone: t, onClick: handleTone, disabled: gameState.status !== 'playing', isSelected: gameState.selectedTone === t, isCorrect: gameState.status === 'correct' && gameState.selectedTone === t }))) :
                        h('button', { onClick: () => startRound(), className: "w-full bg-white text-[#1e5e41] font-black py-6 rounded-3xl text-2xl uppercase tracking-widest shadow-2xl active:scale-95 transition-all" }, "Next Word")
                ),
                h('div', { className: "flex justify-between items-center opacity-30 px-2" },
                    h('button', { onClick: () => setShowPhonetics(!showPhonetics), className: "text-[10px] font-bold uppercase tracking-widest hover:opacity-100 transition-opacity" }, showPhonetics ? 'üôà Hide Phonetics' : 'üëÅÔ∏è Show Phonetics'),
                    h('p', { className: "text-[10px] font-bold uppercase tracking-widest" }, "Tap word to replay")
                )
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(h(React.StrictMode, null, h(App)));
    </script>
</body>
</html>
